<div ui-view="shell"></div>

<div class="container main-container reports">
    <div class="row header-row">
        <div class="col l3 m4 s11">
            <h2>Details</h2>
        </div>
        <div class="col l1 m1 s1 offset-l8 offset-m7 offset-s0">
            <a ng-href="#" class="center">
                <i class="material-icons notification-icon">notifications</i>
            </a>
        </div>
    </div>

    <div class="row head-information">
        <p>Submitted by <span>{{ report.Creator.UserName }}</span> at <span>{{ report.Timestamp | date: "h:mma" }}</span> on <span>{{ report.Timestamp | date: "MM-dd-yyyy" }}</span>
        
    </div>
    <div class="row report-map">
        <map center="{{ report.Location.Latitude }}, {{ report.Location.Longitude }}" zoom="19" styles="[{stylers:[{hue:'#18C0D6'},{visibility:'simplified'},{gamma:0.5},{weight:0.5}]},{featureType:'water',stylers:[{color:'#37474f'}]}]">
            <custom-marker position="{{ report.Location.Latitude }}, {{ report.Location.Longitude }}">
                <img src="/assets/img/map-marker.png"/>
            </custom-marker>
        </map>
    </div>
    <div class="row report-assignment">
        <h4 ng-if="!assignedUser">Assign user to resolve</h4>
        <p ng-if="assignedUser"><span>{{ assignedUser.UserName}}</span> is currently assigned to resolve this report.
        </p>
        <form role="form" name="createAssignmentForm" novalidate>
            <div class="col l11 m11 s10" style="padding: 0;">
                <input style="margin-bottom: 0;" ng-class="{ 'valid' : createAssignmentForm.userName.$touched && createAssignmentForm.userName.$valid, 'invalid' : createAssignmentForm.userName.$touched && createAssignmentForm.userName.$invalid }" id="userName" name="userName" placeholder="Type username here" type="text" ng-model="userName" required />
                <small class="validation" ng-show="createAssignmentForm.userName.$touched && createAssignmentForm.userName.$error.required">Username is required.</small>
            </div>
            <div class="col l1 m1 s2">
                <button href="#" class="btn-floating waves-effect waves-light" ng-click="assignUser(userName)" ng-disabled="createAssignmentForm.$invalid || createAssignmentForm.$pristine">
                    <i class="material-icons">add</i>
                </button>
            </div>
        </form>
    </div>
    <div class="row general-information">
        <h4>General information</h4>
        <div class="col s12" style="padding: 0">
            <h5>Description</h5>
            <p ng-if="report.Description">{{ report.Description }}</p>
            <p ng-if="!report.Description">Client has not provided a description for this report.</p>
        </div>
        <div class="col l4 m4 s12" style="padding: 0">
            <h5>Category</h5>
            <p>{{ report.Category.Name }}</p>
        </div>
        <div class="col l4 m4 s12" style="padding: 0">
            <h5>Location</h5>
            <p>{{ report.Location.Name }} ({{ report.Location.Latitude }}, {{ report.Location.Longitude }})</p>
        </div> 
    </div>
    <div class="row additional-details">
        <h4>Additional details</h4>
        <div class="col s12" ng-if="report.Details.CustomPropertyValues.length > 0" ng-repeat="detail in report.Details.CustomPropertyValues">
            <h5>{{ detail.CustomProperty.Name }}</h5>
            <p ng-if="detail.CustomProperty.CustomPropertyType == 'CheckBox' && detail.SerializedValue == 'True' ">Yes</p>
            <p ng-if="detail.CustomProperty.CustomPropertyType == 'CheckBox' && detail.SerializedValue == 'False' ">No</p>
            <p ng-if="detail.CustomProperty.CustomPropertyType == 'Field' ">{{ detail.SerializedValue }}</p>
        </div>
        <p ng-if="report.Details.CustomPropertyValues.length == 0">Client has not provided any additional details for this report.</p>
    </div>
    <div class="row resources">
        <h4>Pictures</h4>
        <div class="col l2 m4 s6" ng-if="report.Resources.length > 0" ng-repeat="resource in report.Resources"> 
            <img materialboxed class="materialboxed responsive-img" ng-src="{{ resource.Base64 }}">
        </div>
        <p ng-if="report.Resources.length == 0">Client has not provided any pictures for this report.</p>
    </div>
</div>